{"version":3,"file":"server.legacy.test.js","names":["_serverLegacy","require","test","f","createLegacyTestServer","expect","inject","method","url","then","res","json","resolves","toEqual","todoItems","payload","code","error","message","statusCode","id","label","state","dueDateMs","Date","getTime"],"sources":["../../src/__tests__/server.legacy.test.ts"],"sourcesContent":["import { createLegacyTestServer } from \"./server.legacy.fixtures\";\n\ntest(`server.legacy`, async () => {\n  const f = createLegacyTestServer({}, {}, {});\n\n  await expect(\n    f\n      .inject({\n        method: `get`,\n        url: `/item`,\n      })\n      .then((res) => res.json()),\n  ).resolves.toEqual({ todoItems: [] });\n\n  await expect(\n    f\n      .inject({\n        method: `post`,\n        url: `/item`,\n        payload: {},\n      })\n      .then((res) => res.json()),\n  ).resolves.toEqual({\n    code: `FST_ERR_VALIDATION`,\n    error: `Bad Request`,\n    message: `body must have required property 'id'`,\n    statusCode: 400,\n  });\n\n  await expect(\n    f\n      .inject({\n        method: `post`,\n        url: `/item`,\n        payload: {\n          id: 1337,\n          label: `test item`,\n          state: `todo`,\n        },\n      })\n      .then((res) => res.json()),\n  ).resolves.toEqual({\n    code: `FST_ERR_VALIDATION`,\n    error: `Bad Request`,\n    message: `body/id must match format \"uuid\"`,\n    statusCode: 400,\n  });\n\n  await expect(\n    f\n      .inject({\n        method: `post`,\n        url: `/item`,\n        payload: {\n          id: `e7f7082a-4f16-430d-8c3b-db6b8d4d3e73`,\n          label: `todo`,\n          state: `todo`,\n          dueDateMs: new Date(1337).getTime(),\n        },\n      })\n      .then((res) => res.json()),\n  ).resolves.toEqual({\n    todoItems: [\n      {\n        id: `e7f7082a-4f16-430d-8c3b-db6b8d4d3e73`,\n        label: `todo`,\n        state: `todo`,\n        dueDateMs: new Date(1337).getTime(),\n      },\n    ],\n  });\n\n  await expect(\n    f\n      .inject({\n        method: `put`,\n        url: `/item/1337`,\n      })\n      .then((res) => res.json()),\n  ).resolves.toEqual({\n    code: `FST_ERR_VALIDATION`,\n    error: `Bad Request`,\n    message: `params/id must match format \"uuid\"`,\n    statusCode: 400,\n  });\n});\n"],"mappings":";;AAAA,IAAAA,aAAA,GAAAC,OAAA;AAEAC,IAAI,CAAE,eAAc,EAAE,YAAY;EAChC,MAAMC,CAAC,GAAG,IAAAC,oCAAsB,EAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EAE5C,MAAMC,MAAM,CACVF,CAAC,CACEG,MAAM,CAAC;IACNC,MAAM,EAAG,KAAI;IACbC,GAAG,EAAG;EACR,CAAC,CAAC,CACDC,IAAI,CAAEC,GAAG,IAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAC7B,CAAC,CAACC,QAAQ,CAACC,OAAO,CAAC;IAAEC,SAAS,EAAE;EAAG,CAAC,CAAC;EAErC,MAAMT,MAAM,CACVF,CAAC,CACEG,MAAM,CAAC;IACNC,MAAM,EAAG,MAAK;IACdC,GAAG,EAAG,OAAM;IACZO,OAAO,EAAE,CAAC;EACZ,CAAC,CAAC,CACDN,IAAI,CAAEC,GAAG,IAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAC7B,CAAC,CAACC,QAAQ,CAACC,OAAO,CAAC;IACjBG,IAAI,EAAG,oBAAmB;IAC1BC,KAAK,EAAG,aAAY;IACpBC,OAAO,EAAG,uCAAsC;IAChDC,UAAU,EAAE;EACd,CAAC,CAAC;EAEF,MAAMd,MAAM,CACVF,CAAC,CACEG,MAAM,CAAC;IACNC,MAAM,EAAG,MAAK;IACdC,GAAG,EAAG,OAAM;IACZO,OAAO,EAAE;MACPK,EAAE,EAAE,IAAI;MACRC,KAAK,EAAG,WAAU;MAClBC,KAAK,EAAG;IACV;EACF,CAAC,CAAC,CACDb,IAAI,CAAEC,GAAG,IAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAC7B,CAAC,CAACC,QAAQ,CAACC,OAAO,CAAC;IACjBG,IAAI,EAAG,oBAAmB;IAC1BC,KAAK,EAAG,aAAY;IACpBC,OAAO,EAAG,kCAAiC;IAC3CC,UAAU,EAAE;EACd,CAAC,CAAC;EAEF,MAAMd,MAAM,CACVF,CAAC,CACEG,MAAM,CAAC;IACNC,MAAM,EAAG,MAAK;IACdC,GAAG,EAAG,OAAM;IACZO,OAAO,EAAE;MACPK,EAAE,EAAG,sCAAqC;MAC1CC,KAAK,EAAG,MAAK;MACbC,KAAK,EAAG,MAAK;MACbC,SAAS,EAAE,IAAIC,IAAI,CAAC,IAAI,CAAC,CAACC,OAAO,CAAC;IACpC;EACF,CAAC,CAAC,CACDhB,IAAI,CAAEC,GAAG,IAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAC7B,CAAC,CAACC,QAAQ,CAACC,OAAO,CAAC;IACjBC,SAAS,EAAE,CACT;MACEM,EAAE,EAAG,sCAAqC;MAC1CC,KAAK,EAAG,MAAK;MACbC,KAAK,EAAG,MAAK;MACbC,SAAS,EAAE,IAAIC,IAAI,CAAC,IAAI,CAAC,CAACC,OAAO,CAAC;IACpC,CAAC;EAEL,CAAC,CAAC;EAEF,MAAMpB,MAAM,CACVF,CAAC,CACEG,MAAM,CAAC;IACNC,MAAM,EAAG,KAAI;IACbC,GAAG,EAAG;EACR,CAAC,CAAC,CACDC,IAAI,CAAEC,GAAG,IAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAC7B,CAAC,CAACC,QAAQ,CAACC,OAAO,CAAC;IACjBG,IAAI,EAAG,oBAAmB;IAC1BC,KAAK,EAAG,aAAY;IACpBC,OAAO,EAAG,oCAAmC;IAC7CC,UAAU,EAAE;EACd,CAAC,CAAC;AACJ,CAAC,CAAC"}